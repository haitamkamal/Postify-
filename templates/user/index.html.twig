{% extends 'base.html.twig' %}

{% block title %}Home
{% endblock %}

{% block body %}
	{% if app.user %}
		<!-- User Info Box -->
		<div class="mb-3">
			<a href="#" onclick="toggleUserInfo(event)">
				<img src="{{ asset('uploads/profile_images/' ~ (app.user.profileImage ? app.user.profileImage : 'default_image.png')) }}" alt="Profile Image" style="width: 60px; height: 60px; border-radius: 50%;">
			</a>

			<div
				id="user-info" style="display: none; margin-top: 10px;">
				<!-- Become Admin -->
				<a href="{{ path('upgrade_to_admin') }}">
					<img src="{{ asset('uploads/images/admin-alt.png') }}" alt="Prendre Vip" title="Prendre Vip" style="width: 30px; height: 30px; border-radius: 20%; cursor: pointer;">
				</a>
				<br>
				<!-- Logout -->
				<a href="{{ path('app_logout') }}">
					<img src="{{ asset('uploads/images/exit.png') }}" alt="Déconnexion" title="Déconnexion" style="width: 30px; height: 30px; border-radius: 20%; cursor: pointer;">
				</a>
			</div>
		</div>

		<!-- User Details -->
		<div>
			<p>Nom d'utilisateur :
				{{ app.user.username }}</p>


			<!-- Profile Settings -->
			<a href="{{ path('profile') }}">
				<img src="{{ asset('uploads/images/settings.png') }}" alt="paramètres" title="paramètres" style="width: 30px; height: 30px; border-radius: 20%;">
			</a>
		</div>

		<!-- Friends Link -->
		<a href="{{ path('member_list') }}">
			<img src="{{ asset('uploads/images/friends_icon.png') }}" alt="Voir tes amis" title="Voir tes amis" style="width: 30px; height: 30px; border-radius: 20%;">
		</a>

		<!-- Scripts -->
		<script>
			function toggleUserInfo(event) {
event.preventDefault();
const userInfo = document.getElementById("user-info");
userInfo.style.display = userInfo.style.display === "none" ? "block" : "none";
}

function toggleMemberInfo(event, id) {
event.preventDefault();
const memberInfo = document.getElementById("member-info-" + id);
if (memberInfo) {
memberInfo.style.display = memberInfo.style.display === "none" ? "block" : "none";
}
}
		</script>
	{% endif %}

	<hr>

	<!-- Member List -->
	<h2>Discussion</h2>
	<div style="display: flex; flex-wrap: wrap; gap: 15px;">
		{% for member in members %}
			<div style="text-align: center;">
				<a href="#" onclick="toggleMemberInfo(event, {{ member.id }})">
					<img src="{{ asset('uploads/profile_images/' ~ (member.profileImage ? member.profileImage : 'default_image.png')) }}" alt="Profile Image" style="width: 60px; height: 60px; border-radius: 50%;">
				</a>

				<div id="member-info-{{ member.id }}" style="display: none; margin-top: 10px;">
					<a href="{{path('app_discussion',{'id': member.id}) }}">Envoi message</a>


				</div>

				<p>
					<a href="{{ path('member_profile', {'id': member.id}) }}" style="text-decoration: none; color: inherit;">
						{{ member.username }}
					</a>
					{% if member.id == app.user.id %}
						(moi)
					{% endif %}
				</p>
			</div>
		{% endfor %}
	</div>
{% endblock %}
